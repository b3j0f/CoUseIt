{% extends "base.html" %}
{% block content %}

<div class="container">

	<div class="section scrollspy" name="Sondages" id="surveys">

		<h1 class="center">Sondages</h1>

		{% if surveys %}

		{% for survey in surveys %}

		<div class="card hoverable">

			<div class="card-content">

				{% include 'chart.html' with surveydata=survey desc=True vote=True %}

			</div>

		</div>

		{% endfor %}

		{% else %}

		Pas de sondage de créé.

		{% endif %}

	</div>

	<form action="/surveys" method="post" class="add-entry row">

		<div id="addsurvey" class="modal">

			<div class="modal-content">

				<h2 class="center">Proposer un sondage</h2>

				{% csrf_token %}
				<div class="input-field col s6">
					<i class="material-icons prefix">title</i>
					<input type="text" id="title" name="title" required />
					<label for="title" class="validate">Titre</label>
				</div>
				<div class="input-field col s6">
					<i class="material-icons prefix">website</i>
					<input type="text" id="url" name="name" required />
					<label for="url" class="validate">Site web</label>
				</div>
				<div class="input-field col s4">
					<i class="material-icons prefix">list</i>
					<label>Type</label>
					<select name="kind" id="kind" required>
						<option value="binary">Binaire/par approbation</option>
						<option value="ordered">Ordonné</option>
						<option value="ranked" selected>Notation</option>
						<option value="ranked2">Jugement majoritaire</option>
					</select>
				</div>
				<div class="input-field col s4">
					<i class='material-icons prefix'>date_range</i>
					<input type="date" class="datepicker" name="opened" id="opened" />
					<label for="opened">Début</label>
				</div>
				<div class="input-field col s4">
					<i class='material-icons prefix'>update</i>
					<input type="closed" class="datepicker" name="closed" id="closed" />
					<label for="closed">Fin</label>
				</div>
				<div class="input-field col s12">
					<textarea name="description" id="description" class="materialize-textarea" required ></textarea>
					<label for="description" class="validate">Description</label>
				</div>
			</div>
			<div class="modal-footer">
				<div class="input-field">
					<button type="submit" class="waves-green btn-flat waves-effect" name="action">Ajouter</button>
				</div>
			</div>
		</div>
	</form>

	<div class="fixed-action-btn">
		<a class="btn-floating btn-large red waves-effect waves-light" href="{% if user.is_authenticated %}#addsurvey{% else %}/login?next=surveys{% endif %}">
			<i class="material-icons">add</i>
		</a>
	</div>

</div>

<script type="text/javascript">

/*
var survey = {name: '', description: '', url: '', proposals: []};
var kind = 'ranked';

function changeType(elt) {
	kind = elt.value;
	if (kind === 'single') {
		$('singleform').show();
		$('rankedform').hide();
	} else {
		$('singleform').hide();
		$('rankedform').show();
	}
}

setRanked();
function setSingle() {

}

function addproposal() {
	$('proposals').innerElement.add(
		'<>'
	);
}
function removeproposal(proposal) {
	proposal.remove();
}*/

</script>

{% endblock %}
